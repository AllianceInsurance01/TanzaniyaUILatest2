<div class="card">
    <div class="card-header">Broker Configuration</div>
    <div class="card p-1">
        <div class="vision-grid vision-grid-column-2">
            <div class="vision-grid-item">
                <div class="radio-toolbar menu-bar">
                    <input type="radio" id="menu1" name="menu" value="Branch" (click)="onRedirect('Branch')" [(ngModel)]="activeMenu">
                    <label for="menu1">Branch</label>
                    <input id="menu7" type="radio" name="menu" value="Product" [(ngModel)]="activeMenu" (click)="onRedirect('Product')">
                    <label for="menu7">Product</label>

                    <input type="radio" id="menu2" name="menu" value="Cover" (click)="onRedirect('Cover')" [(ngModel)]="activeMenu">
                    <label for="menu2">Cover</label>
                    <input type="radio" id="menu8" name="menu" value="Deposit" (click)="onRedirect('Deposit')" [(ngModel)]="activeMenu">
                    <label for="menu8">Deposit</label>
              
                </div>
            </div>
            <div class="vision-grid-item">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between">
                            <div>
                                Existing Products
                            </div>
                            <div>
                                <button *ngIf="!editSection" class="btn btn-warning" (click)="editSection=!editSection">Add / Remove Product</button>
                                <!-- <button class="btn btn-warning" (click)="onAddNewProduct()">Add New</button> -->
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div style="background: transparent;" class="example-container">
                            
                            <div [hidden]="!editSection">
                                <div class="input-form-box" style="margin-right: 5px !important;" id="gridstyle" >
                                    <input type="text" class="input-form-control with-icon" (keyup)="applyFilter($event.target.value)" placeholder="Filter">
                                    <span class="input-form-icon">
                                        <i class="fas fa-filter"></i>
                                    </span>
                                </div>
                                <div style="width: 100%;overflow-y: scroll !important;">
                                    <table mat-table [dataSource]="dataSource" class="ux-table-v" matSort [matSortActive]="sortProperty" [matSortDirection]="sortDirection" matSortDisableClear>
                                        <ng-container *ngFor="let col of productHeader; let i = index;" [matColumnDef]="col.key" [sticky]="i===0" [stickyEnd]="i === 10">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header class="table-header mat-header-cell">
                                                <ng-container *ngIf="productHeader[i]['display']=='Premium' || productHeader[i]['display']=='Endorsement Premium'">
                                                    {{ productHeader[i]["display"] }} &nbsp; ({{Currency}})
                                                </ng-container>
                                                <ng-container *ngIf="productHeader[i]['display']=='Endorsements Premium'">
                                                    Premium &nbsp; ({{Currency}})
                                                </ng-container>
                                                <ng-container *ngIf="productHeader[i]['display']=='EndorsementStatus'">
                                                    Status
                                                </ng-container>
                                                <ng-container *ngIf="productHeader[i]['display']!='Premium' && productHeader[i]['display']!='Endorsements Premium' && productHeader[i]['display']!='Endorsement Premium' && productHeader[i]['display']!='EndorsementStatus'">
                                                    {{ productHeader[i]["display"] }}
                                                </ng-container>
                                            </th>
                                            <td mat-cell *matCellDef="let element; let j = index;" [ngClass]="[element?.Active == true && i==0 ? 'cutomBg1' : 'cutomBg2',col.key=='Status' && element[col.key]=='D' ? 'deletedBg' : 'cutomBg2']">
                                                <ng-container *ngIf="!col.config; else hasConfig">
                                                    <ng-container *ngIf="col.key=='ProductName'">
                                                        <ng-container *ngIf="element.ProductId=='5'">
                                                            {{ element[col.key] }}&nbsp;-&nbsp;{{element.PolicyTypeDesc}}
                                                        </ng-container>
                                                        <ng-container *ngIf="element.ProductId!='5'">
                                                            {{ element[col.key] }}
                                                        </ng-container>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='CommissionPercent'">
                                                        <div class="input-control-container">
                                                            <div class="input-form-box">
                                                                <input type="text" class="input-form-control without-icon" [disabled]="element.SelectedYn!='Y'" style="width: 90px;" maxlength="5" [(ngModel)]="element[col.key]">
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='BackDays'">
                                                        <div class="input-control-container">
                                                            <div class="input-form-box">
                                                                <input type="text" class="input-form-control without-icon" [disabled]="element.SelectedYn!='Y'" style="width: 80px;" maxlength="5" [(ngModel)]="element[col.key]">
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='SumInsuredEnd'">
                                                        <div class="input-control-container">
                                                            <div class="input-form-box">
                                                                <input type="text" class="input-form-control without-icon" digitOnly [disabled]="element.SelectedYn!='Y'" (keydown)="onSIEndChange($event)" (keyup)="CommaFormatted(element)" style="width: 150px;" maxlength="25" [(ngModel)]="element[col.key]">
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='CreditYn'">
                                                        <div class="input-form-radio-box">
                                                            <div class="radio-toolbar" style="width: 120px;">
                                                                <input [id]="'credit_Yes'+j" type="radio" [name]="'creditYN'+j" [disabled]="element.SelectedYn!='Y'" [(ngModel)]="element[col.key]" value="Y">
                                                                <label [for]="'credit_Yes'+j" class="customLabel">Yes</label>
                                                                <input type="radio" [id]="'credit_No'+j" [name]="'creditYN'+j" [disabled]="element.SelectedYn!='Y'" [(ngModel)]="element[col.key]" value="N">
                                                                <label [for]="'credit_No'+j" class="customLabel">No</label>
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='EffectiveDate'">
                                                        <mat-form-field appearance="fill" style="width: 130px;">
                                                            <input matInput [matDatepicker]="picker" [min]="minDate" [(ngModel)]="element[col.key]" [disabled]="element.SelectedYn!='Y'" [ngModelOptions]="{standalone: true}">
                                                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                                            <mat-datepicker #picker></mat-datepicker>
                                                        </mat-form-field>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='CheckerYn'">
                                                        <div class="input-form-radio-box">
                                                            <div class="radio-toolbar" style="width: 120px;">
                                                                <input [id]="'checker_Yes'+j" type="radio" [name]="'checkerYN'+j" [disabled]="element.SelectedYn!='Y'" [(ngModel)]="element[col.key]" value="Y">
                                                                <label [for]="'checker_Yes'+j" class="customLabel">Yes</label>
                                                                <input type="radio" [id]="'checker_No'+j" [name]="'checkerYN'+j" [disabled]="element.SelectedYn!='Y'" [(ngModel)]="element[col.key]" value="N">
                                                                <label [for]="'checker_No'+j" class="customLabel">No</label>
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='Select'">
                                                        <mat-checkbox class="example-margin text-center" [checked]="checkSelectedProducts(element)" (change)="onChangeSelectedProduct(element)">
                                                        </mat-checkbox> 
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key=='Status'">
                                                        <div class="input-form-radio-box">
                                                            <div class="radio-toolbar" style="width: 170px;">
                                                                <input [id]="'orginwarehouse_Yes'+j" type="radio" [name]="'originatingWarehouse'+j" [(ngModel)]="element[col.key]" value="Y">
                                                                <label [for]="'orginwarehouse_Yes'+j" class="customLabel">Active</label>
                                                                <input type="radio" [id]="'orginwarehouse_No'+j" [name]="'originatingWarehouse'+j" [(ngModel)]="element[col.key]" value="N">
                                                                <label [for]="'orginwarehouse_No'+j" class="customLabel">DeActive</label>
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="productHeader[i]['display']=='EndorsementStatus'">
                                                            <span *ngIf="element[col.key]=='P'">Pending</span>
                                                            <span *ngIf="element[col.key]=='N'">Cancelled</span>
                                                            <span *ngIf="element[col.key]=='C' && element?.endorsementTypeId!=842">Completed</span>
                                                            <span *ngIf="element[col.key]=='C' && element?.endorsementTypeId==842">Cancelled</span>
                                                            <span *ngIf="endorsementSection && element[col.key]==null">Base policy</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.key!='Status' && col.key!='ProductName' && col.key!='Select' && col.key!='CommissionPercent' && col.key!='EffectiveDate' && col.key!='SumInsuredEnd' && col.key!='CheckerYn' && col.key!='CreditYn' && col.key!='BackDays'  && productHeader[i]['display']!='EndorsementStatus' && productHeader[i]['display']!='Endorsements Premium' && productHeader[i]['display']!='Endorsement Premium'">
                                                        {{ element[col.key] }}
                                                    </ng-container>
                                                    <ng-container *ngIf="productHeader[i]['display']=='Endorsements Premium' || productHeader[i]['display']=='Endorsement Premium'">
                                                        <ng-container *ngIf="element[col.key]==0 || element[col.key]=='0'">
                                                                N/A
                                                        </ng-container>
                                                        <ng-container *ngIf="element[col.key]!=0 && element[col.key]!='0'">
                                                            {{ element[col.key] }}
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container>
                                                <ng-template #hasConfig>
                                                    <ng-container *ngIf="col.config.isChecked">
                                                        <mat-checkbox class="example-margin" [(ngModel)]="element[col.config.model]" (change)="onSelectCustomer.emit(element)"></mat-checkbox>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.select">
                                                        <div class="custom-control custom-radio custom-control-inline">
                                                            <input type="radio" class="custom-control-input" id="customRadio{{element[col.key]}}" name="example" [value]="element[col.key]" [checked]="onCheckCustomer(element)" (change)="onSelect(element)">
                                                            <label class="custom-control-label" for="customRadio{{element[col.key]}}"></label>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isEdit">
                                                       <button class="btn btn-primary btn-sm" (click)="onEditProduct(element)">
                                                            <i class="fas fa-marker"></i>
                                                          </button>&nbsp;
                                                    </ng-container>
                                
                                                    <ng-container *ngIf="col.config.isPolicyConfig">
                                                        <button mat-button [matMenuTriggerFor]="menu">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <mat-menu #menu="matMenu">
                                                            <button mat-menu-item (click)="onSchedule.emit(element)"><i class="fas fa-file"></i>&nbsp;Schedule</button>
                                                            <button mat-menu-item (click)="onView.emit(element)"><i class="fas fa-eye"></i>&nbsp;View Quote Details</button>
                                                        </mat-menu>
                                                    </ng-container>
                                                    <!-- <ng-container *ngIf="col.config.isschedules">
                                                    <button class="btn btn-primary btn-sm" (click)="onGetSchedule.emit({data:element,name:'Schedule'})">
                                                        <i class="fas fa-marker"></i>
                                                    </button>
                                                </ng-container> -->
                                                    <ng-container *ngIf="col.config.isEndorseEdit">
                                                        <ng-container *ngIf="element?.endorsementStatus">
                                                            <ng-container *ngIf="element?.endorsementStatus=='C'">
                                                                <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                                                    <i class="fas fa-ellipsis-v"></i>
                                                                </button>
                                                                <mat-menu #menu="matMenu">
                                                                    <!-- <button mat-menu-item (click)="onOpenCoverAction.emit({data:element,name:'Certificate'})">
                                                                        <span>Certificate</span>
                                                                    </button> -->
                                                                    <button mat-menu-item (click)="onGetSchedule.emit({data:element,name:'Schedule'})">
                                                                        <span>Schedule</span>
                                                                    </button>
                                                                    <!-- <button mat-menu-item>
                                                                        <span>Policy Wording</span>
                                                                    </button> -->
                                                                </mat-menu>
                                                            </ng-container>
                                                            <ng-container *ngIf="element.endorsementStatus==null">
                                                                        N/A
                                                            </ng-container>
                                                            <ng-container *ngIf="element.endorsementStatus!='C' && element.endorsementStatus!=null">
                                                                <button class="btn btn-primary btn-sm" (click)="onEdit.emit(element)">
                                                                    <i class="fas fa-marker"></i>
                                                                  </button>
                                                            </ng-container>
                                                        </ng-container>
                                                        <ng-container *ngIf="element?.endorsementStatus==undefined">
                                                            <ng-container *ngIf="((this.endorsementSection && !this.enableAddVehicle) || (this.endorsementSection && this.enableAddVehicle && element['EndorsementYn']=='Y'))">
                                                                <button class="btn btn-primary btn-sm" (click)="onEdit.emit(element)" *ngIf="element.endorsementStatus!=null">
                                                                     <i class="fas fa-marker"></i>
                                                                </button>
                                                                <ng-container *ngIf="element.endorsementStatus==null">
                                                                        N/A
                                                                </ng-container>
                                                            </ng-container>
                                                            <ng-container *ngIf="(this.endorsementSection && this.enableAddVehicle && element['EndorsementYn']!='Y')">
                                                                N/A
                                                            </ng-container>
                                                        </ng-container>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.Edit">
                                                        <!--<button class="btn btn-primary btn-sm" (click)="onEdits.emit(element)"> </button>-->
                                                        <textarea cols="15" rows="2" maxlength="30" [(ngModel)]="ClausesDesc"></textarea>
                                                        <!--<i class="fas fa-marker"></i>-->
                                
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isConfigure">
                                                        <div class="text-center">
                                                            <button class="btn btn-primary btn-sm" (click)="onConfigure(element)">
                                                                <i class="fas fa-cog"></i>
                                                              </button>
                                                        </div>
                                                        
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isRemove">
                                                        <button class="btn btn-danger btn-sm" (click)="onDelete.emit(element)">
                                                        <i class="fas fa-trash"></i>
                                                      </button>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isPremiums">
                                                        <div class="d-flex" style="justify-content: flex-end;" (click)="onTotals.emit(element)">
                                                            {{element.OverallPremiumLc}}
                                                            </div>
                                                        </ng-container>
                                
                                                    <ng-container *ngIf="col.config.isViews">
                                                        <button class="circle btn btn-primary btn-sm" (click)="onViews.emit(element)">
                                                          <i class="fas fa-eye"></i>
                                                        </button>&nbsp;
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isOpenGridAction">
                                                        <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                                <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                        <mat-menu #menu="matMenu">
                                                            <button mat-menu-item>
                                                                <span>Lc Details</span>
                                                            </button>
                                                            <button mat-menu-item (click)="onOpenCoverAction.emit({data:element,name:'Certificate'})">
                                                                <span>Certificate</span>
                                                            </button>
                                                            <button mat-menu-item (click)="onOpenCoverAction.emit({data:element,name:'Schedule'})">
                                                                <span>Schedule</span>
                                                            </button>
                                                            <button mat-menu-item>
                                                                <span>Policy Wording</span>
                                                            </button>
                                                        </mat-menu>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.config.isCoverRatingEdit">
                                                        <ng-container *ngIf="element.SubCoverYn=='N'">
                                                            <button class="btn btn-primary btn-sm" (click)="onCoverRatingEdit.emit(element)">
                                                                <i class="fas fa-cog"></i>
                                                              </button>
                                                        </ng-container>
                                                        <ng-container *ngIf="element.SubCoverYn!='N'">
                                                           N/A
                                                        </ng-container>
                                                    </ng-container>
                                
                                               <!-- subCover-->  <ng-container *ngIf="col.config.isSubCoverRatingEdit">
                                                        <ng-container *ngIf="element.SubCoverYn=='Y'">
                                                            <button class="btn btn-primary btn-sm" (click)="onSubCoverRatingEdit.emit(element)">
                                                                <i class="fas fa-cog"></i>
                                                              </button>
                                                        </ng-container>
                                                        <ng-container *ngIf="element.SubCoverYn!='Y'">
                                                           N/A
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-template>
                                            </td>
                                        </ng-container>
                                
                                        <tr mat-header-row *matHeaderRowDef="keys"></tr>
                                        <tr mat-row *matRowDef="let row; columns: keys"></tr>
                                    </table>
                                </div>
                                
                                <ng-container *ngIf="!dataSource.data.length">
                                    <table>
                                        <tr>
                                            <td class="p-3" style="text-align: center" [attr.colspan]="productHeader?.length">
                                                No Records Found!
                                            </td>
                                        </tr>
                                    </table>
                                </ng-container>
                                <mat-paginator class="mat-paginator-sticky" [pageSizeOptions]="[5, 10, 15]" showFirstLastButtons aria-label="Select page of periodic elements">
                                </mat-paginator>
                            </div>
                            <ng-container *ngIf="!editSection">
                                <ng-container *ngIf="newList.length!=0">
                                    <app-grid-table [cols]="productHeaderAlt" [data]="newList" [filterValue]="filterValue" (onEdit)="onEditProduct($event)" (onConfigure)="onConfigure($event)">
                                    </app-grid-table>
                                </ng-container>
                                <ng-container *ngIf="newList.length==0">
                                    <div class="text-center">
                                        No Products Added
                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                        
                        <!--  -->
                        <div class="text-center mt-2">
                            <button class="btn btn-danger" *ngIf="editSection" (click)="editSection=!editSection">Cancel</button>&nbsp;
                            <button class="btn btn-danger" *ngIf="!editSection" (click)="getBackPage()">Back</button>&nbsp;
                            <button class="btn btn-success" *ngIf="editSection" (click)="onSaveProductDetails()">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
